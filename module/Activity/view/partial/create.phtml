<?php

declare(strict_types=1);

use Activity\Form\Activity as ActivityForm;
use Application\View\HelperTrait;
use Laminas\View\Renderer\PhpRenderer;

/**
 * @var PhpRenderer|HelperTrait $this
 * @var ActivityForm $form
 */

$lang = $this->plugin('translate')->getTranslator()->getLocale();
?>
<div class="row">
    <div class="col-md-12">
        <h2><?= $this->translate('Information') ?></h2>
        <p><?= $this->translate('What is this activity about? Fill in the blanks below, please note that at least one language must be used.') ?></p>
    </div>
    <div class="col-md-6">
        <?php
        $checkboxDutch = $form->get('language_dutch')
            ->setAttribute('id', 'dutch-check')
            ->setAttribute('class', 'language-control');
        ?>
        <div class="form-group <?= $this->bootstrapElementError($checkboxDutch) ?>">
            <label for="<?= $checkboxDutch->getAttribute('id') ?>" class="control-label"
                   title="<?= $this->translate('Enable Dutch Translations') ?>">
                <?= $this->formCheckbox($checkboxDutch) ?>
                <span class="flag-icon flag-icon-nl"></span>
                <?= $this->translate('Dutch') ?>
            </label>
            <?= $this->formElementErrors($checkboxDutch) ?>
        </div>
        <hr>
        <?php
        $name = $form->get('name')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-dutch')
            ->setAttribute('id', 'name-nl');
        $name->setValue($this->localisedTextElement($name));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($name) ?>">
            <label for="<?= $name->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Name') ?>
            </label>
            <?= $this->formText($name) ?>
            <?= $this->formElementErrors($name) ?>
        </div>
        <?php
        $location = $form->get('location')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-dutch')
            ->setAttribute('id', 'location-nl');
        $location->setValue($this->localisedTextElement($location));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($location) ?>">
            <label for="<?= $location->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Location') ?>
            </label>
            <?= $this->formText($location) ?>
            <?= $this->formElementErrors($location) ?>
        </div>
        <?php
        $costs = $form->get('costs')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-dutch')
            ->setAttribute('id', 'cost-nl');
        $costs->setValue($this->localisedTextElement($costs));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($costs) ?>">
            <label for="<?= $costs->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Costs') ?>
            </label>
            <?= $this->formText($costs) ?>
            <?= $this->formElementErrors($costs) ?>
        </div>
        <?php
        $description = $form->get('description')
            ->setAttribute('class', 'form-control form-control-dutch')
            ->setAttribute('style', 'width:100%; height:10em; resize:none')
            ->setAttribute('id', 'description-nl');
        $description->setValue($this->localisedTextElement($description));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($description) ?>">
            <label for="<?= $description->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Description') ?>
            </label>
            <?= $this->formTextarea($description) ?>
            <?= $this->formElementErrors($description) ?>
        </div>
    </div>
    <div class="col-md-6">
        <?php
        $checkboxEnglish = $form->get('language_english')
            ->setAttribute('id', 'english-check')
            ->setAttribute('class', 'language-control');
        ?>
        <div class="form-group <?= $this->bootstrapElementError($checkboxEnglish) ?>">
            <label for="<?= $checkboxEnglish->getAttribute('id') ?>" class="control-label"
                   title="<?= $this->translate('Enable English Translations') ?>">
                <?= $this->formCheckbox($checkboxEnglish) ?>
                <span class="flag-icon flag-icon-en"></span>
                <?= $this->translate('English') ?>
            </label>
            <?= $this->formElementErrors($checkboxEnglish) ?>
        </div>
        <hr>
        <?php
        $nameEn = $form->get('nameEn')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-english')
            ->setAttribute('id', 'name-en');
        $nameEn->setValue($this->localisedTextElement($nameEn));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($nameEn) ?>">
            <label for="<?= $nameEn->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Name') ?>
            </label>
            <?= $this->formText($nameEn) ?>
            <?= $this->formElementErrors($nameEn) ?>
        </div>
        <?php
        $locationEn = $form->get('locationEn')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-english')
            ->setAttribute('id', 'location-en');
        $locationEn->setValue($this->localisedTextElement($locationEn));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($locationEn) ?>">
            <label for="<?= $locationEn->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Location') ?>
            </label>
            <?= $this->formText($locationEn) ?>
            <?= $this->formElementErrors($locationEn) ?>
        </div>
        <?php
        $costsEn = $form->get('costsEn')
            ->setAttribute('disabled', 'disabled')
            ->setAttribute('class', 'form-control form-control-english')
            ->setAttribute('id', 'cost-en');
        $costsEn->setValue($this->localisedTextElement($costsEn));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($costsEn) ?>">
            <label for="<?= $costsEn->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Costs') ?>
            </label>
            <?= $this->formText($costsEn) ?>
            <?= $this->formElementErrors($costsEn) ?>
        </div>
        <?php
        $descriptionEn = $form->get('descriptionEn')
            ->setAttribute('class', 'form-control form-control-english')
            ->setAttribute('style', 'width:100%; height:10em; resize:none')
            ->setAttribute('id', 'description-en');
        $descriptionEn->setValue($this->localisedTextElement($descriptionEn));
        ?>
        <div class="form-group <?= $this->bootstrapElementError($descriptionEn) ?>">
            <label for="<?= $descriptionEn->getAttribute('id') ?>" class="control-label">
                <?= $this->translate('Description') ?>
            </label>
            <?= $this->formTextarea($descriptionEn) ?>
            <?= $this->formElementErrors($descriptionEn) ?>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <h2><?= $this->translate('Options') ?></h2>
        <p><?= $this->translate('Choose which options are applicable to this activity.') ?></p>
    </div>
    <div class="col-md-6">
        <?php
        $isMyFuture = $form->get('isMyFuture')
            ->setAttribute('id', 'myfuture-check');
        ?>
        <div class="form-group <?= $this->bootstrapElementError($isMyFuture) ?>">
            <label for="<?= $isMyFuture->getAttribute('id') ?>">
                <?= $this->formCheckbox($isMyFuture) ?>
                <?= $this->translate('This is a career related activity') ?>
                <span data-toggle="tooltip" data-placement="right"
                      title="<?= $this->translate('If this is checked the My Future logo will be displayed on the activity page and the activity will be included on the career activities page.') ?>"
                      class="fas fa-info-circle" aria-hidden="true"></span>
            </label>
            <?= $this->formElementErrors($isMyFuture) ?>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <h2><?= $this->translate('Facilities') ?></h2>
        <p><?= $this->translate('Choose which facilities you would like for this activity.') ?></p>
    </div>
    <div class="col-md-6">
        <?php
        $requireGEFLITST = $form->get('requireGEFLITST')
            ->setAttribute('id', 'GEFLITST-check');
        ?>
        <div class="form-group <?= $this->bootstrapElementError($requireGEFLITST) ?>">
            <label for="<?= $requireGEFLITST->getAttribute('id') ?>">
                <?= $this->formCheckbox($requireGEFLITST) ?>
                <?= $this->translate('This activity needs a GEFLITST member to take photos') ?>
                <span data-toggle="tooltip" data-placement="right"
                      title="<?= $this->translate('When this is checked, GEFLITST will be notified that this activity needs a photographer.') ?>"
                      class="fas fa-info-circle" aria-hidden="true"></span>
            </label>
            <?= $this->formElementErrors($requireGEFLITST) ?>
        </div>
        <?php
        $requireZettle = $form->get('requireZettle')
            ->setAttribute('id', 'Zettle-check');
        ?>
        <div class="form-group <?= $this->bootstrapElementError($requireZettle) ?>">
            <label for="<?= $requireZettle->getAttribute('id') ?>">
                <?= $this->formCheckbox($requireZettle) ?>
                <?= $this->translate('This activity needs a Zettle for payments') ?>
                <span data-toggle="tooltip" data-placement="right"
                      title="<?= $this->translate('When this is checked, the treasurer will be notified that this activity needs a Zettle.') ?>"
                      class="fas fa-info-circle" aria-hidden="true"></span>
            </label>
            <?= $this->formElementErrors($requireZettle) ?>
        </div>
    </div>
</div>
<script nonce="<?= NONCE_REPLACEMENT_STRING ?>">
    document.querySelectorAll('.language-control').forEach(checkbox => {
        checkbox.addEventListener('click', () => {
            Activity.updateForm();
        });
    });

    GEDITOR.MarkdownEditor
        .create(document.querySelector('#description-nl'), {
            language: '<?= $lang ?>'
        })
        .catch(error => {
            console.error(error);
        });

    GEDITOR.MarkdownEditor
        .create(document.querySelector('#description-en'), {
            language: '<?= $lang ?>'
        })
        .catch(error => {
            console.error(error);
        });
</script>
